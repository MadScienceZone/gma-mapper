'\" t
.\" vim:set syntax=nroff:
'\" <<ital-is-var>>
'\" <<bold-is-fixed>>
.TH MAPPER 5 "GMA Toolkit 4.5.0" 20-Nov-2022 "File Formats" \" @@mp@@
.SH NAME
mapper \- battle grid save file format
.SH DESCRIPTION
.LP
The version 17 file format for the
.BR mapper (6)
battle grid program is described in this document.
.LP
The file is plain-text 7-bit ASCII.  Each line describes one 
attribute of one object.  Any given object will be described 
by multiple lines of the file, which are not necessarily 
contiguous, nor are the lines necessarily in any particular 
order in the file.
.LP
The software SHOULD allow Unicode text encoded as UTF-8
everywhere (of which 7-bit ASCII is a subset), but this 
has not been extensively tested, thus the above note that
the file is plain text ASCII.
.LP
Five kinds of objects may appear in this file: map features,
players, monsters, map file references, and images.
.SS "Meta Data"
The first line of the file may have the format:
'\" <<center>>
.RS
.LP
.BI __MAPPER__: version
.RI [ datalist ]
.RE
.LP
Where
.I version
is the map file format version this file conforms to.
While map clients should try to read any file they are given,
they may not be able to understand anything in a file with a
higher version number than they support. Such a client may refuse
to read the file.
.LP
The
.I datalist
parameter is a TCL list of values. 
For version 17 files, this includes
'\" <<center>>
.RS
.LP
.BI { comment
.IB date }
.RE
.LP
where
.I comment
is a string describing what the map represents, and
.I date
is a list containing one or two values: a decimal timestamp of when the file was created,
and optionally a human-readable form of that same timestamp. The human-readable string may be
empty or omitted.
.LP
This line must appear before any other line in the file if it is present.
If it is missing, a client will not know what version of the file format it uses. 
The client may try to read it anyway, generate a warning, or refuse to load the file.
.LP
For example:
'\" <<center>>
.RS
.LP
.B "__MAPPER__:17 {antechamber {1570643001 {Wed Oct 09 10:43:21 PDT 2019}}}"
.RE
.SS "Overall Guidelines"
.LP
Every line in the file is a properly-formatted TCL list string. See the official TCL language
documentation for the full and gory details, but the following should be enough to understand
the file contents described here:
'\" <<itemize>>
.TP 3
\(bu
Each line is a list of values separated by spaces.
.TP
\(bu
Each value in the list is itself surrounded by curly braces if it contains any embedded
spaces (thus, everything inside braces is a single value as far as the list is concerned).
.TP
\(bu
Braces must be balanced.
.TP
\(bu
Braces and backslashes may be escaped with a backslash if they are to be literal characters
rather than having their normal meaning.
.TP
\(bu
Braces should be omitted where they are not required.
.TP
\(bu
There is no syntactic difference between a string value with embedded spaces inside it
and a sub-list; if a string value is expected to be itself a sub-list of values, then
that string value is split on space delimiters just as the outer list was.
(In other words, it's up to the software reading the data to determine whether a particular
value is a string or a list of strings).
'\" <</>>
.LP
Consider the following strings and their meaning as lists of values:
'\" <<TeX>>
'\" \begin{center}
'\"  \begin{tabular}{ll}
'\"   \z{a b c d} & (``a'', ``b'', ``c'', ``d'') \\
'\"   \z{a \{b c\} d} & (``a'', ``b c'', ``d'') \\
'\"   \z{a \{b c\} d} & (``a'', (``b'', ``c''), ``d'') \\
'\"   \z{a b \{\{c d\} e f\}} & (``a'', ``b'', (``c d'', ``e'', ``f'')) \\
'\"   \z{a b \{\{c d\} e f\}} & (``a'', ``b'', ((``c'', ``d''), ``e'', ``f'')) \\
'\"  \end{tabular}
'\" \end{center}
.TS
lB l.
a b c d	("a", "b", "c", "d")
a {b c} d	("a", "b c", "d")
a {b c} d	("a", ("b", "c"), "d")
a b {{c d} e f}	("a", "b", ("c d", "e", "f"))
a b {{c d} e f}	("a", "b", (("c", "d"), "e", "f"))
.TE
'\" <</TeX>>
.LP
One thing that may not be obvious, however, is that the
'\" <</ital-is-var>>
.I entire
line is a TCL list. For a line describing an attribute of
a map feature, the first value in the list is the attribute
name and object ID. The second (and possibly subsequent) values
in the list give the value(s) of that attribute. Some attributes
expect multiple values after the ID, others expect a single value
that is itself a sub-list of values, as documented in each individual
case.
.LP
Valid IDs for the objects described herein must conform to the 
following rules:
'\" <<desc>>
.TP 12
Attributes
The names of all attributes must consist
.I only
of upper-case letters and underscores.
'\" <<ital-is-var>>
.TP
Creatures
The ID given for a creature (monster or player) must consist
only of upper- or lower-case alphabetic characters, digits, underscores
.RB (\*(lq _ \*(rq)
and octothorpes
.RB (\*(lq # \*(rq).
.TP
Features
The ID given for map features must consist of hexadecimal digits
(of any case, but note that
'\" <</ital-is-var>>
.I "case is significant"
'\" <<ital-is-var>>
here), underscores
.RB (\*(lq _ \*(rq)
and octothorpes
.RB (\*(lq # \*(rq).
.TP
Files
The ID given for map files mentioned in this file is not specified here
but is a server-specific value.
Programs which read and write
these files should consider them opaque string values.
.TP
Images
The ID given for images stored on servers is not specified here and
depends on the server implementation. Programs which read and write
these files should consider them opaque string values.
'\" <</>>
.SS "Map Features"
.LP
When describing map features, each line is in the format:
'\" <<center>>
.RS
.LP
.IB attr : id
.RI [ value-list ]
.RE
.LP
where 
.I attr
is the name of the object attribute,
.I id
is the object ID being described, and
.I value-list
is a list of values appropriate to the attribute type, 
if needed by the attribute being described,
formatted as a proper TCL list string.  (In a nutshell: 
space-separated list of text strings. The list or any 
element will be surrounded by curly braces if it contains 
any spaces.)
.LP
Any attribute name which begins with an underscore
.RB (\*(lq _ \*(rq)
is considered to be for internal use only and is not 
documented here nor guaranteed to be useful or understood
by anyone consuming these files. They should be ignored.
.LP
The possible attributes, and their value lists, include:
'\" <<desc>>
.TP 12
.B TYPE
The object type.  May be one of:
.B aoe
(spell area of effect),
.B arc
(filled arc),
.B circ
(filled circle),
.B group
(logical grouping of objects into a single compound object),
.B layer
(definition of a layer),
.B line
(set of one or more connected line segments),
.B poly
(filled polygon),
.B rect
(filled rectangle),
.B text
(text),
.B tile
(decorative background tile),
or
.B token
(OBSOLETE TYPE intended for player or creature token placed on the battle grid, but 
those are now just tiles). Clients are not expected to recognize this type and it may
be removed from this document in the future.
.TP
.B X
The 
.I x
coordinate of the object's reference point on the grid.
.TP
.B Y
The
.I y
coordinate of the object's reference point on the grid.
.TP
.B Z
The
.I z
coordinate of the object. This is the
'\" <</ital-is-var>>
.I "stacking order"
'\" <<ital-is-var>>
of the object on the flat 2D plane of the map, with higher numbers
overlapping lower numbers. Ideally these should be unique within a map
file; which of two objects having the same
.I z
coordinate will be on top is undefined. For the creature's location in
the vertical direction, see the
.B ELEV
attribute.
.TP
.B LEVEL
An integer describing the level on which this object exists.  The mapper
can display maps a level at a time, with a visual stacking effect if appropriate.
Generally, the level numbers increase as one moves farther underground.  By convention,
you may use level 0 for the ground level, and negative level numbers for floors above
ground.
.TP
.B GROUP
The ID number of the group object to which this element belongs.
.TP
.B POINTS
Additional coordinate pairs needed for the object type (e.g.,
the vertices of a polygon or opposing corner of a rectangle).
This is a list of coordinate values as 
.I x1
.I y1
.I x2
.I y2
\&...
.I xn
.I yn
(always an even number of elements).
.TP
.B FILL
The color used to fill in the object.  May be a name, an
RGB color specification 
(e.g., 
.RI \*(lq\fB#\fP rrggbb \*(rq)
or an empty string 
.RB (\*(lq {} \*(rq).
An empty string indicates that
'\" <</ital-is-var>>
.I no
filling will be done.
.TP
.B FONT
The font used to display a text object. This has a form acceptable to Tk as a font name.
.I "(Text objects only.)"
'\" <<ital-is-var>>
.TP
.B TEXT
The text to display in a text object.
'\" <</ital-is-var>>
.I "(Text objects only.)"
'\" <<ital-is-var>>
.TP
.B ANCHOR
The placement of a text object relative to its 
.I x
and 
.I y
coordinates. Values may be
.BR center ,
.BR n ,
.BR s ,
.BR e ,
.BR w ,
.BR ne ,
.BR nw ,
.BR se ,
or
.BR sw .
'\" <</ital-is-var>>
.I "(Text objects only.)"
'\" <<ital-is-var>>
.TP 
.B ARROW
The style of arrow to place on the ends of lines. Values may
be
.B none
(no arrowheads),
.B first
(arrow on initial point of the line),
.B last
(arrow on final point of the line),
or
.B both
(arrows on both ends).
'\" <</ital-is-var>>
.I "(Line objects only)"
'\" <<ital-is-var>>
.TP 
.B DASH
Indicates the dash pattern to use for the lines outlining the shape.
If this is missing or has the empty string as its value
.RB (\*(lq {} \*(rq),
then a solid line is drawn. Otherwise it may have any of the following
values which represent the dash pattern:
.B \-
(long dashes),
.B ,
(medium dashes),
.B .
(short dashes),
.B \-.
(long and short dashes),
or
.B \-..
(one long followed by two short dashes).
.TP
.B LINE
The color used to draw the outline around a filled object.
May be a name or RGB color specification
(e.g., 
.RI \*(lq\fB#\fP rrggbb \*(rq).
.TP
.B WIDTH
The line width used to render the object's outline.
.TP
.B LAYER
The ID of the layer on which this object exists.  In version
1.0 of
.BR mapper ,
this is nearly always
.RB \*(lq walls \*(rq,
because layers are not yet implemented.
The only other value recognized in this attribute is
.RB \*(lq tiles \*(rq
which is rendered underneath
'\" <</ital-is-var>>
.I everything
'\" <<ital-is-var>>
(including grid lines).
.TP
.B JOIN
The line join style.  May be one of:
.BR bevel ,
.B miter
or 
.BR round .
'\" <</ital-is-var>>
.I "(Polygon objects only.)"
'\" <<ital-is-var>>
.TP
.B SPLINE
The number of lines to use per polygon line segment for spline
curve smoothing.  0 (zero) means no smoothing (just straight lines
between points). 
'\" <</ital-is-var>>
.I "(Polygon objects only.)"
'\" <<ital-is-var>>
.TP
.B ARCMODE
The drawing style of an arc object.  May be
.BR pieslice ,
.BR arc ,
or
.BR chord .
'\" <</ital-is-var>>
.I "(Arc objects only.)"
'\" <<ital-is-var>>
.TP
.B START
The starting angle for the arc, in degrees counter-clockwise from
the 3:00 position.
'\" <</ital-is-var>>
.I "(Arc objects only.)"
'\" <<ital-is-var>>
.TP
.B EXTENT
The extent of the angle for the arc, in degrees counter-clockwise 
from the start position.
'\" <</ital-is-var>>
.I "(Arc objects only.)"
'\" <<ital-is-var>>
.TP
.B HIDDEN
If this attribute is true, the object (which may be a group) is not shown
at all on the map.  If a group is hidden, none of its constituent objects
need this attribute set.
.TP
.B IMAGE
The name of the image to be displayed for this element.
The value is fairly arbitrary and must already have been defined by loading the
image via the network connection. If it wasn't, a file will be looked for
in the tile cache directory.
'\" <</ital-is-var>>
.I "(Tile objects only.)"
'\" <<ital-is-var>>
.TP
.B BBHEIGHT
The pixel height of the bounding box for the image named in the 
.B IMAGE
attribute when the map is zoomed at the default level. 
'\" <</ital-is-var>>
.I "(Tile objects only.)"
'\" <<ital-is-var>>
.TP
.B BBWIDTH
The pixel width of the bounding box for the image named in the 
.B IMAGE
attribute when the map is zoomed at the default level. 
'\" <</ital-is-var>>
.I "(Tile objects only.)"
'\" <<ital-is-var>>
.TP
.B AOESHAPE
The shape of the area of effect 
.RB ( aoe
type objects only).
May be one of:
.BR cone ,
.BR radius ,
or
.BR ray .
.TP
.B LOCKED
A boolean value. If false (or this attribute is not present), then this object
may be edited by clients. Otherwise, the object is immutable. Clients should not
even recognize the object as a candidate to be selected for operations or modified
by the user. It just becomes part of the background. (This is intended to prevent
accidentally moving fundamental items such as the dungeon background images when
clicking on something else.)
.LP
Programs should accept any additional attributes not listed here
but need not process them.
'\" <</>>
.SS "Monsters"
.LP
Each line describing a monster has the form:
'\" <<center>>
.RS
.LP
.B M
.IB attr : id
.RI [ value-list ]
.RE
.LP
where 
.RS
.LP
.I id
is the object ID of the creature being described, 
.I attr
is one of the attributes described below, and 
.I value-list
is the list of values for that attribute (see the
Map Features section above for a description of how
these may appear).
.RE
.LP
The attributes for monsters include:
'\" <<desc>>
.TP 14
.B TYPE
The type of creature. May be one of: 
.B player
or
.BR monster .
.TP
.B NAME
The displayed name of the creature.
.TP
.B GX
The 
.I x
coordinate of the creature on the battle grid
'\" <</ital-is-var>>
.I "in grid units" 
'\" <<ital-is-var>>
(not pixel units).
.TP
.B GY
The 
.I y
coordinate of the creature on the battle grid
'\" <</ital-is-var>>
.I "in grid units" 
'\" <<ital-is-var>>
(not pixel units).
.TP
.B HEALTH
The creature's current health status. If its value is the empty
string or the attribute is missing, no health information is
being tracked for this creature. Otherwise, this is a list 
with the following elements:
'\" <<desc>>
.RS
.TP 10
.I max
Maximum hit points (at full health).
.TP
.I lethal
Number of hit points lost due to suffering lethal damage. 
.TP
.I sub
Number of hit points lost due to suffering non-lethal damage.
.TP
.I con
Number by which hit points are allowed to drop below zero before death occurs.
.TP
.I flat
A boolean indicating if the creature is flat-footed.
.TP
.I stable
A boolean indicating if the creature was stabilized.
.TP
.I condition
The creature's condition. Under normal circumstances this is left
as the empty string, in which case the map client will automatically
assess and report the creature's condition based on the other health
parameters. Putting a non-empty value in this element overrides all
such calculation, forcing the reported condition to be whatever is
explicitly given here.
This only considers conditions directly related to their
injury/health level, and may be one of the following:
.B normal
(none of the below-named conditions are in effect),
.BR flat ,
.BR staggered ,
.BR unconscious ,
.BR stable ,
.BR disabled ,
or
.BR dying .
.RS
.LP
There is not a specific 
.I condition
code to indicate that the creature is dead. This is indicated by the
.B KILLED
attribute, which overrides any meaning of the
.B HEALTH
attribute. (I.e., if 
.B KILLED
is true, the 
.B HEALTH
attribute is ignored other than to indicate that a health bar is
desired at all for the creature.)
.LP
This value shoud be set to the empty string unless you wish to manually
override the condition. If a value is placed here for
.IR condition ,
then that is the condition. Otherwise, the condition is calculated from
the other stats listed here.
.RE
.TP
.I blur
This is an optional element which indicates the percentage of
\*(lqblur\*(rq applied to the reported lethal damage amount
by the GM's server. See 
.BR mapper (6)
for a description of this effect. If this element is omitted,
is the empty string, or has a value less than or equal to 0,
this means the GM's server is reporting accurate values.
.RE
'\" <</>>
.TP
.B ELEV
The creature's elevation relative to some convenient reference point, such
as sea level or the floor of the room they're standing in (or, as the case may
in fact be, flying above). If they are resting on the ground (i.e., at the 
reference elevation), this should be 0 (zero). This value need not be an integer.
.TP
.B MOVEMODE
The means of locomotion used by the creature is indicated by this attribute.
It may be one of:
.BR fly ,
.BR climb ,
.BR swim ,
.BR burrow ,
or
.B land
(the latter indicating the creature is moving normally along
the ground, typically by walking or running.)
If this attribute is set to the empty string, the default mode
of
.RB \*(lq land \*(rq
is assumed.
.TP
.B COLOR
The color name for the threat zone around the creature.
.TP
.B NOTE
An arbitrary text label to note special conditions of that creature,
such as being weakened, dazed, blinded, etc.
.TP
.B SKIN
For creatures with multiple images (such as shapechangers), this gives the
image number currently displayed on the map. The default (base) image is
0.
.TP
.B SKINSIZE
For creatures with multiple images (such as shapechangers), provides a list of
size codes corresponding to their legal skin numbers.
This is a list of 
.I n
values for creatures which can have
.I n
different images, where each element gives the size of
each skin starting with skin 0. For example, if the base creature is medium-size,
as is its first alternate image, but it has one additional image that is large,
the
.B SKINSIZE
attribute would have a value of
.BR "{M M L}" .
.TP
.B SIZE
The size of the area occupied by the creature. May be an integer number
of squares or one of the size category codes
.B F
(fine),
.B D
(diminutive),
.B T
(tiny),
.B S
(small),
.B M
(medium),
.B L
(large),
.B H
(huge),
.B G
(gargantuan),
.B C
(colossal).
Capital letters indicate tall creatures while lower-case indicates long
creatures, for size categories where that makes a difference.
.TP
.B STATUSLIST
This is a list of status values which indicate the condition of the creature.
The exact list of statuses is configurable by the GM but the 
standard mapper comes with the following set:
'\" <<desc>>
.RS
.TP 16
.B "ability drained"
Marked with a small orange downward triangle on the left of the token.
.TP
.B bleed
Marked with a small red downward triangle on the left of the token.
.TP
.B blinded
Black double-slash (//) through the token.
.TP
.B confused
Orange double-horizontal lines through the token.
.TP
.B cowering
Brown double-horizontal lines through the token.
.TP
.B dazed
Purple double-horizontal lines through the token.
.TP
.B dazzled
Cyan double-slash (//) through the token.
.TP
.B deafened
Small black diamond at the left of the token.
.TP
.B disabled
Red vertical line through the token.
.TP
.B dying
Slash (/) through the token in the creature's area-fill color.
.TP
.B "energy drained"
Small black downward triangle on the right of the token.
.TP
.B entangled
Green hash (#) through the token.
.TP
.B exhausted
Red downward triangle around the token.
.TP
.B fascinated
Cyan double-horizontal lines through the token.
.TP
.B fatigued
Orange downward triangle around the token.
.TP
.B flat-footed
Blue ring around the token.
.TP
.B frightened
Yellow diamond around the token.
.TP
.B grappled
Orange cross (+) through the token.
.TP
.B helpless
Gray double-horizontal lines through the token.
.TP
.B incorporeal
Gray ring around the token.
.TP
.B invisible
Dashed black ring around the token.
.TP
.B nauseated
Green upward triangle around the token.
.TP
.B panicked
Red diamond around the token.
.TP
.B paralyzed
Black double-horizontal lines through the token.
.TP
.B petrified
Gray X drawn through the token.
.TP
.B pinned
Red cross (+) through the token.
.TP
.B poisoned
Small green circle at the right of the token.
.TP
.B prone
Blue line through the token.
.TP
.B shaken
Brown diamond around the token.
.TP
.B sickened
Brown upward triangle around the token.
.TP
.B stable
Small brown diamond at the right of the token.
.TP
.B staggered
Blue double-horizontal lines through the token.
.TP
.B stunned
Red double-horizontal lines through the token.
.TP
.B unconscious
Purple double vertical line through the token.
'\" <</>>
.LP
Additional values are permitted but will be silently ignored by clients unless
they have been defined locally (e.g., by the 
.B DSM
protocol command). In this way, any number of conditions and their corresponding
markers may be put in use for a particular game.
These markers are used to draw status indicators on the creature tokens even when not
in battle conditions, whereas the
.B HEALTH
attribute is more combat-oriented and will auto-generate some conditions
if that attribute exists.
.LP
Similar symbols are used for conditions that have similar effects (e.g.,
double horizontal lines for conditions usually associated with denying
some or all normal actions to the creature).
.RE
.TP
.B AOE
If this attibute exists and has a non-empty value, then the creature
has an ongoing magic emanation effect centered on them currently in effect.
The 
.I value
is a list with at least one element. The first element gives the shape
of the emanation. The supported shapes are:
'\" <<desc>>
.RS
.TP 8
.B radius
This specifies a spherical area centered
.I around
.I the
.I perimeter
of the creature's occupied space. The remaining elements in
the list are:
'\" <<desc>>
.RS
.TP 8
.I r
The radius of the effect, in number of grid squares.
.TP
.I color
The color with which to fill in the area on the map.
.RE
.RE
'\" <</>>
'\" <</>>
.TP
.B AREA
The threatened area around the creature, using the same values
as for
.B SIZE
(see above).
.TP
.B REACH
Integer value indicating if the creature currently has reach mode enabled.
0 indicates normal melee threat range for the creature's size. 1 indicates
that a reach weapon is in use, so that it only threatens far spaces but
not adjacent ones. 2 indicates that the full range from the creature out
to the reach limit is threatened.
.TP
.B KILLED
Boolean value indicating if the creature is currently dead.
.TP
.B DIM
Boolean value indicating if the creature is currently
.I not
in the active initiative slot.
'\".TP
'\".B SELECTED
'\"Boolean value indicating if the creature is currently selected on the map.
'\" <</>>
.LP
Programs should accept any additional attributes not listed here
but need not process them.
.SS "Players"
.LP
Each line describing a player has the form:
'\" <<center>>
.RS
.LP
.B P
.IB attr : id
.RI [ value-list ]
.RE
.LP
and has the same format as monsters (see above).
.SS "Maps"
Each line describing a server-side map file which may be retrieved by a client has the form:
'\" <<center>>
.RS
.LP
.B F
.I fileID
.RE
.LP
where
.I fileID
is the server-side ID code used to retrieve the file.
.LP
For example, given the map file line
.LP
'\" <<center>>
.RS
.B F
.B abcdefghijklmnop
.RE
.LP
the mapper will retrieve the file from a web server at a URL such as
.br
.BR https://example.com/gma/map/a/ab/abcdefghijklmnop.map .
Note that the presence of this line causes the map client to retrieve the
file into its local cache in preparation to read it at a future point. It does
not cause the file to be opened and its contents displayed.
.SS "Images"
Each line describing an image has the form:
'\" <<center>>
.RS
.LP
.B I
.I imageID
.I zoom
.I filename
.RE
.LP
where
.I imageID
is an identifier for the image,
.I zoom
is the zoom factor this image is displayed for,
and
.I filename
is the name on disk where the image file should be loaded from.
This is a pathname opened just as given in the file (i.e., it is
relative to the current working directory of the 
.B mapper
process unless it is an absolute pathname).
.LP
If
.I filename
begins with an at-sign 
.RB (\*(lq @ \*(rq)
character, then rather than being a local filename it is instead an
ID tag used to download the image file from an external service.
(The 
.BR rendersizes (6)
utility knows how to generate these files appropriately and will
create suitable entries in a map file for them if given a
.B \-w
option.)
.LP
Typically these files will be available from a web server using a URL
based on the remaining characters of
.IR filename .
.LP
For example, given the map file line
.LP
'\" <<center>>
.RS
.B I
.B #SimonKazar
.B 1.0
.B #SimonKazar@50.gif
.RE
.LP
the mapper will load the contents of the local disk file
.BR #SimonKazar@50.gif ,
and use that to display the image
with the internal (to the mapper) image name 
.B #SimonKazar
(which it would automatically do for a character token for a creature
named 
.B SimonKazar
who was still living), at zoom factor 1.0.
.LP
On the other hand, the line
.LP
.na
'\" <<center>>
.RS
.B I
.B #Firefly
.B 2.0
.B @0oSmGY0XERJRrA8ZiK_igg_Firefly@100
.RE
.ad
.LP
tells the mapper client that the image data for the tile
.B #Firefly
at zoom factor 2.0 may be obtained from a web server at a URL
such as
'\" <<center>>
.RS
.B https://example.com/gma/map/0/0o/0oSmGY0XERJRrA8ZiK_igg_Firefly@100.gif
.RE
(although multiple image formats may be provided other than GIF, which the client
may request using appropriate filename suffixes; the specific formats provided are
site-dependent but for the author's game they include GIF, JPEG, and PNG formats
with suffixes
.BR .gif ,
.BR .jpg ,
and
.B .png 
respectively).
.SH EXAMPLE
'\" <<TeX>>
'\" \begin{SourceCode}
'\" __MAPPER__:17 {{Example map} {1570643001 {Wed Oct 09 10:43:21
'\" PDT 2019}}}
'\" TYPE:1 line
'\" LINE:1 black
'\" FILL:1 #00e400
'\" X:1 425
'\" Y:1 107
'\" WIDTH:1 5
'\" LAYER:1 walls
'\" POINTS:1 {433 337 553 392 600 243 424 108}
'\" TYPE:2 rect
'\" LINE:2 black
'\" FILL:2 #00e400
'\" WIDTH:2 5
'\" X:2 593
'\" LAYER:2 walls
'\" POINTS:2 {807 443}
'\" Y:2 122
'\" \end{SourceCode}
.LP
.nf
.na
\fB
__MAPPER__:17 {{Example map} {1570643001 {Wed Oct 09 10:43:21 PDT 2019}}}
TYPE:1 line
LINE:1 black
FILL:1 #00e400
X:1 425
Y:1 107
WIDTH:1 5
LAYER:1 walls
POINTS:1 {433 337 553 392 600 243 424 108}
TYPE:2 rect
LINE:2 black
FILL:2 #00e400
WIDTH:2 5
X:2 593
LAYER:2 walls
POINTS:2 {807 443}
Y:2 122
\fP
.fi
.ad
'\" <</TeX>>
.LP
This file contains two objects: 
.LP
#1 is a black line filled in the shade of green with (R=0, G=0xe4, B=0), with 
line segments of width 5 going between points (425,107) \- 
(433,337) \- (553,392) \- (600,243) \- (424,108).
.LP
#2 is a black rectangle filled in with the same shade of 
green as line #1, with a line width of 5, between opposing 
corners (593,122) and (807,443).
.SH "WEIRD SIZES"
.LP
While the mapper implements the standard d20/Pathfinder creature size categories,
including tall (uppercase) and wide (lowercase) variants, sometimes there are special
cases which fall outside that list. The following special codes are also usable:
'\" <<desc>>
.TP 8
.B L0/l0
Large creature with no threat zone and no reach (such as a swarm of 
teensy critters).
.TP
.B M20/m20
Medium creature (5-foot space, 5-foot threat zone) with a 20-foot reach zone.
'\" <</>>
.SH "SEE ALSO"
.LP
.BR mapper (6),
.BR rendersizes (6).
.SH FILES
'\" <<desc>>
.TP
.BI ~/.gma/mapper/cache/ name @ zoom .gif
The GIF-format file for image with the given
.I name
and scaled to the given
.I zoom
factor.
.TP
.BI ~/.gma/mapper/cache/ id .map
The map file with server ID
.IR id .
'\" <</>>
.SH HISTORY
.LP
This describes the 4.0 (GMA/Python) and 3.19 (Standalone Tcl/Tk) versions of
.BR mapper .
.SS "Changes as of File Format 2"
.LP
Version 2 files differ from version 1 files in that they add the
.BR JOIN ,
.BR SPLINE ,
.BR START ,
.B EXTENT
and
.B ARCMODE
attributes, the
.B arc
object type, and the "no-fill" (empty string) mode for the
.B FILL
attribute.
.SS "Changes as of File Format 3"
.LP
This file retains compatibility with the version 2 format,
with the following differences.
.LP
Each object now has a
.I z
coordinate in addition to the 
.RI ( x , y )
coordinates of its reference point as in previous versions.
The
.I z
coordinate indicates the display \*(lqstacking order\*(rq 
of objects on the screen.  Each object is \*(lqflat\*(rq
and are rendered in order from the smallest to the largest
value of
.I z
so that the lowest
.I z
value is at the \*(lqbottom\*(rq with the others overlapping
on top of them.  These serve only to indicate the relative
positioning of objects.  There is no absolute meaning to
any particular value for
.IR z .
.LP
Added the
.BR HIDDEN ,
.BR LEVEL ,
and 
.B GROUP
object attributes.
.SS "Changes as of File Format 4"
.LP
This format is compatible with File Format 3, except that it adds the following 
attributes to support tile objects:
'\" <<desc>>
.TP
.B LAYER
The layer attribute may now include the value
.B tiles
which is rendered below everything else, including the grid lines.
.TP
.B IMAGE
This attribute appeared for the first time in this version.
.TP
.B SIZE
This attribute appeared for the first time in this version.
'\" <</>>
.LP
Programs which read newer version files should deal 
correctly with older files which do not contain the newer
elements.
.SS "Changes as of File Format 5"
.LP
This introduced images, creatures, and spell areas of effect.
.SS "Changes as of File Format 6"
.LP
The image definition syntax was extended to allow externally downloaded
image files.
.SS "Changes as of File Format 7"
.LP
Additional creature attributes were added, such as
.BR NOTE 
and
.BR SKIN .
.SS "Changes as of File Format 8"
.LP
Added text objects. This includes the addition of the
.BR ANCHOR ,
.BR FONT ,
and
.B TEXT
attributes.
.SS "Changes as of File Format 9"
.LP
Added 
.B ARROW
and 
.B DASH
attributes. For backward compatibility with format 8,
if either of these are missing from the file, defaults
are assumed.
.SS "Changes as of File Format 10"
.LP
Added
.B ELEV
and
.B MOVEMODE
attributes.
.SS "Changes as of File Format 11"
.LP
Added
.B HEALTH
attribute.
.SS "Changes as of File Format 12"
.LP
Added 
.B F
record type.
.SS "Changes as of File Format 13"
.LP
Added the optional
.I blur
element of the
.B HEALTH
attribute.
Removed the
.B SELECTED
attribute. This is a transient state used during the mapper program's
operation and has no point being saved with the object. This attribute
was moved to the private name
.B _SELECTED
instead.
.SS "Changes as of File Format 14"
.LP
Added the
.B STATUSLIST
attribute.
.SS "Changes as of File Format 15"
.LP
Added the
.B SKINSIZE
attribute.
.SS "Changes as of File Format 16"
.LP
Added the
.B LOCKED
attribute.
.SS "Changes as of File Format 17"
.LP
.B SIZE
only applies to creature tokens.
The version 16 document incorrectly specified that map elements
(notably tiles) also had a
.B SIZE
attribute but this was never implemented. Instead, they had
unofficial attributes
.B _BBHEIGHT
and
.B _BBWIDTH
which have now been promoted to official status as
.B BBHEIGHT
and
.BR BBWIDTH .
.SH AUTHOR
.LP
Steve Willoughby / steve@madscience.zone;
Elevation and movement modes added by John Mechalas.
.SH BUGS
.LP
The
.BR LEVEL ,
.BR GROUP ,
and
.B LAYER
attributes are not actually implemented yet in the mapper program. They're documented
here and will be accepted by the mapper but none of their behavior documented above
will actually happen.
.LP
The
.B token
object type is deprecated and clients are free to be unaware of its existence.

.SH COPYRGHT
Part of the GMA software suite, copyright \(co 1992\-2022 by Steven L. Willoughby, Aloha, Oregon, USA. All Rights Reserved. Distributed under BSD-3-Clause License. \"@m(c)@